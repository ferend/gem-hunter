/*! For license information please see main.e8c762c15623aa79c4a3.bundle.js.LICENSE.txt */
(()=>{var e,t={621:(e,t,s)=>{"use strict";s(260);class a{constructor(e){this.rows=e.rows,this.columns=e.columns,this.items=e.items}generateField(){this.gameArray=new Array,this.selectedItem=!1;for(let e=0;e<this.rows;e++){this.gameArray[e]=[];for(let t=0;t<this.columns;t++)do{let s=Math.floor(Math.random()*this.items);this.gameArray[e][t]={value:s,isEmpty:!1,row:e,column:t}}while(this.isPartOfMatch(e,t))}}isPartOfMatch(e,t){return this.isPartOfHorizontalMatch(e,t)||this.isPartOfVerticalMatch(e,t)}isPartOfHorizontalMatch(e,t){return this.valueAt(e,t)===this.valueAt(e,t-1)&&this.valueAt(e,t)===this.valueAt(e,t-2)||this.valueAt(e,t)===this.valueAt(e,t+1)&&this.valueAt(e,t)===this.valueAt(e,t+2)||this.valueAt(e,t)===this.valueAt(e,t-1)&&this.valueAt(e,t)===this.valueAt(e,t+1)}isPartOfVerticalMatch(e,t){return this.valueAt(e,t)===this.valueAt(e-1,t)&&this.valueAt(e,t)===this.valueAt(e-2,t)||this.valueAt(e,t)===this.valueAt(e+1,t)&&this.valueAt(e,t)===this.valueAt(e+2,t)||this.valueAt(e,t)===this.valueAt(e-1,t)&&this.valueAt(e,t)===this.valueAt(e+1,t)}valueAt(e,t){return!!this.validPick(e,t)&&this.gameArray[e][t].value}validPick(e,t){return e>=0&&e<this.rows&&t>=0&&t<this.columns&&null!=this.gameArray[e]&&null!=this.gameArray[e][t]}getRowNumber(){return this.rows}getColumnNumber(){return this.columns}setCustomData(e,t,s){this.gameArray[e][t].customData=s}customDataOf(e,t){return this.gameArray[e][t].customData}getSelectedItem(){return this.selectedItem}setSelectedItem(e,t){this.selectedItem={row:e,column:t}}deleselectItem(){this.selectedItem=!1}areTheSame(e,t,s,a){return e==s&&t==a}areNext(e,t,s,a){return Math.abs(e-s)+Math.abs(t-a)==1}swapItems(e,t,s,a){let i=Object.assign(this.gameArray[e][t]);return this.gameArray[e][t]=Object.assign(this.gameArray[s][a]),this.gameArray[s][a]=Object.assign(i),[{row:e,column:t,deltaRow:e-s,deltaColumn:t-a},{row:s,column:a,deltaRow:s-e,deltaColumn:a-t}]}removeMatches(){this.getMatchList().forEach((e=>{this.setEmpty(e.row,e.column)}))}getMatchList(){let e=[];for(let t=0;t<this.rows;t++)for(let s=0;s<this.columns;s++)this.isPartOfMatch(t,s)&&e.push({row:t,column:s});return e}setEmpty(e,t){this.gameArray[e][t].isEmpty=!0}isEmpty(e,t){return this.gameArray[e][t].isEmpty}emptySpacesBelow(e,t){let s=0;if(e!=this.getRowNumber())for(let a=e+1;a<this.getRowNumber();a++)this.isEmpty(a,t)&&s++;return s}arrangeBoardAfterMatch(){var e=new Array;for(let t=this.getRowNumber()-2;t>=0;t--)for(let s=0;s<this.getColumnNumber();s++){let a=this.emptySpacesBelow(t,s);!this.isEmpty(t,s)&&a>0&&(this.swapItems(t,s,t+a,s),e.push({row:t+a,column:s,deltaRow:a,deltaColumn:0}))}return e}replenishBoard(){var e=new Array;for(let t=0;t<this.getColumnNumber();t++)if(this.isEmpty(0,t)){let s=this.emptySpacesBelow(0,t)+1;for(let a=0;a<s;a++){let i=Math.floor(Math.random()*this.items);e.push({row:a,column:t,deltaRow:s,deltaColumn:0}),this.gameArray[a][t].value=i,this.gameArray[a][t].isEmpty=!1}}return e}matchInBoard(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)if(this.isPartOfMatch(e,t))return!0;return!1}}const i=106,r=50,n=300;class o extends Phaser.GameObjects.Sprite{constructor(e,t,s,a,i){super(e,t,s,a,i),this.scene=e,this.scene.add.existing(this)}}class h extends Phaser.Scene{constructor({key:e}){super({key:e})}create(){this.screenCenter=[u.scale.width/2,u.scale.height/2],u.canGoBack&&this.add.text(u.scale.width/2,u.scale.height/2,"BACK").setOrigin(1).setScale(1).setInteractive().on("pointerup",(()=>{this.scene.start("MenuScene")}));var e={key:"bgAnimation",frames:this.anims.generateFrameNumbers("bg",{start:15,end:0,first:0}),frameRate:2,repeat:-1};this.anims.create(e),this.add.sprite(-20,-20,"bg").setOrigin(0,0).play("bgAnimation").setScale(1.5)}}class c{constructor(e,t){this.currentScore=0,this.scene=e,this.scoreText=t,this.scene.events.on("chatsubo",(()=>{this.increaseScore(10,this.scoreText)}),this),this.scene.events.on("save",(()=>{this.savePlayerScoreToLocal()}),this)}increaseScore(e,t){this.currentScore+=e,t.setText("Score: "+this.currentScore)}savePlayerScoreToLocal(){0!==this.currentScore&&localStorage.setItem("playerScore",this.currentScore.toString())}}class l{constructor(e,t){this.scene=e,this.time=t,this.createTimer()}createTimer(){const e=this.scene.add.text(u.scale.width/2+220,u.scale.height/2-500,"Time: "+this.time,{fontSize:"40px",color:"#ffffff",fontFamily:"Trebuchet MS"}).setOrigin(.5);var t=this.scene.time.addEvent({delay:1e3,loop:!0,callbackScope:this,callback:()=>{this.time--,e.setText("Time: "+this.time),0===this.time&&(this.scene.time.removeEvent(t),this.scene.events.emit("save"),this.scene.scene.start("GameOverScene"))}})}}const u={type:Phaser.AUTO,backgroundColor:"#ffffff",canGoBack:!0,scale:{parent:"phaser-game",mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH,width:720,height:1280},scene:[class extends h{constructor(){super({key:"PreloadScene"})}preload(){this.load.image("phaser-logo","assets/img/phaser-logo.png"),this.load.spritesheet("spritesheet","assets/img/spritesheet.png",{frameWidth:120,frameHeight:118}),this.load.spritesheet("bg","assets/img/spritesheet2.png",{frameWidth:1280,frameHeight:960})}create(){this.scene.start("MenuScene")}},class extends h{constructor(){super({key:"MainScene"})}create(){super.create(),this.engine=new a({rows:7,columns:6,items:6}),this.engine.generateField(),this.dragging=!1,this.createField(),this.input.on("pointerdown",this.pickGem,this),this.createScoreText(),this.player=new c(this,this.scoreText),this.pauseButton(),this.gameTimer=new l(this,180)}createScoreText(){this.scoreText=this.add.text(u.scale.width/2,u.scale.height/2-500,"Score: 0",{fontSize:"40px",color:"#ffffff",fontFamily:"Trebuchet MS"}).setOrigin(.5)}pauseButton(){this.add.text(u.scale.width/2-240,u.scale.height/2-500,"PAUSE",{fontSize:"32px",fontStyle:"bold",color:"#ffffff"}).setOrigin(.5).setInteractive().on("pointerdown",(()=>{this.scene.pause(),this.physics.pause(),this.scene.launch("PauseScene"),this.events.emit("save")}))}createField(){this.poolArray=new Array;for(let e=0;e<this.engine.getRowNumber();e++)for(let t=0;t<this.engine.getColumnNumber();t++){let s=new o(this,r+i*t+53,n+i*e+53,"spritesheet",this.engine.valueAt(e,t));this.engine.setCustomData(e,t,s)}}pickGem(e){this.dragging=!0;let t=Math.floor((e.y-n)/i),s=Math.floor((e.x-r)/i);if(this.engine.validPick(t,s)){let e=this.engine.getSelectedItem();e?this.engine.areTheSame(t,s,e.row,e.column)?(this.engine.customDataOf(t,s).setScale(1),this.engine.deleselectItem()):this.engine.areNext(t,s,e.row,e.column)?(this.engine.customDataOf(e.row,e.column).setScale(1),this.engine.deleselectItem(),this.swapGems(t,s,e.row,e.column,!0)):(this.engine.customDataOf(e.row,e.column).setScale(1),this.engine.customDataOf(t,s).setScale(1.2),this.engine.setSelectedItem(t,s)):(this.engine.customDataOf(t,s).setScale(1.2),this.engine.customDataOf(t,s).setDepth(1),this.engine.setSelectedItem(t,s))}}swapGems(e,t,s,a,r){let n=this.engine.swapItems(e,t,s,a);this.swappingGems=2,n.forEach((n=>{this.tweens.add({targets:this.engine.customDataOf(n.row,n.column),x:this.engine.customDataOf(n.row,n.column).x+i*n.deltaColumn,y:this.engine.customDataOf(n.row,n.column).y+i*n.deltaRow,duration:200,callbackScope:this,onComplete:()=>{this.swappingGems--,0==this.swappingGems&&(this.engine.matchInBoard()?this.handleMatches():r&&this.swapGems(e,t,s,a,!1))}})}))}handleMatches(){let e=this.engine.getMatchList(),t=0;e.forEach((e=>{this.poolArray.push(this.engine.customDataOf(e.row,e.column)),t++,this.tweens.add({targets:this.engine.customDataOf(e.row,e.column),alpha:0,duration:200,callbackScope:this,onComplete:()=>{t--,0==t&&this.makeGemsFall()}}),0!==t&&this.events.emit("chatsubo")}))}makeGemsFall(){this.engine.removeMatches();let e=this.engine.arrangeBoardAfterMatch();this.endOfMove(),e.forEach((e=>{this.tweens.add({targets:this.engine.customDataOf(e.row,e.column),y:this.engine.customDataOf(e.row,e.column).y+e.deltaRow*i,duration:100*Math.abs(e.deltaRow),callbackScope:this,onComplete:()=>{}})})),this.engine.replenishBoard().forEach((e=>{let t=this.poolArray.pop();t.alpha=1,t.y=n+i*(e.row-e.deltaRow+1)-53,t.x=r+i*e.column+53,t.setFrame(this.engine.valueAt(e.row,e.column)),this.engine.setCustomData(e.row,e.column,t),this.tweens.add({targets:t,y:n+i*e.row+53,duration:100*e.deltaRow,callbackScope:this,onComplete:function(){}})}))}endOfMove(){this.engine.matchInBoard()?this.time.addEvent({delay:200,callback:()=>this.handleMatches()}):this.selectedGem=null}},class extends h{constructor(){super({key:"MenuScene"})}create(){super.create(),this.gameTitletext(),this.startButton(),null!==localStorage.getItem("playerScore")&&this.bestScoreText()}gameTitletext(){return this.add.text(u.scale.width/2,u.scale.height/2,"Gem Hunter",{fontSize:"64px",color:"#ffffff",fontFamily:"Trebuchet MS"}).setOrigin(.5)}startButton(){this.add.text(u.scale.width/2,u.scale.height/2+150,"Play",{fontSize:"40px",color:"#ffffff",fontFamily:"Trebuchet MS"}).setOrigin(.5).setScale(1).setInteractive().on("pointerup",(()=>{this.scene.stop(),this.scene.start("MainScene")}))}bestScoreText(){return this.add.text(u.scale.width/2,u.scale.height/2+300,"Best Score : "+localStorage.getItem("playerScore"),{fontSize:"40px",color:"#ffffff",fontFamily:"Trebuchet MS"}).setOrigin(.5)}},class extends h{constructor(){super({key:"PauseScene"})}create(){super.create(),this.gamePausedText(),this.continueGameText(),this.returnToMenuText()}gamePausedText(){return this.add.text(u.scale.width/2,u.scale.height/2,"Game Paused",{fontSize:"64px",color:"#ffffff",fontFamily:"Trebuchet MS"}).setOrigin(.5)}continueGameText(){var e=this.add.text(u.scale.width/2,u.scale.height/2+150,"Continue",{fontSize:"40px",color:"#ffffff",fontFamily:"Trebuchet MS"}).setOrigin(.5).setScale(1);e.setInteractive(),e.on("pointerup",(()=>{this.scene.resume("MainScene"),this.scene.stop()}))}returnToMenuText(){var e=this.add.text(u.scale.width/2,u.scale.height/2+300,"Menu",{fontSize:"40px",color:"#ffffff",fontFamily:"Trebuchet MS"}).setOrigin(.5).setScale(1);e.setInteractive(),e.on("pointerup",(()=>{window.location.reload()}))}},class extends h{constructor(){super({key:"GameOverScene"})}create(){super.create(),this.gameOverText(),this.returnToMenuButton(),this.bestScoreText()}gameOverText(){return this.add.text(u.scale.width/2,u.scale.height/2,"Game Over",{fontSize:"64px",color:"#ffffff",fontFamily:"Trebuchet MS"}).setOrigin(.5)}returnToMenuButton(){const e=this.add.text(u.scale.width/2,u.scale.height/2+150,"Return to Menu",{fontSize:"40px",color:"#ffffff",fontFamily:"Trebuchet MS"}).setOrigin(.5).setScale(1).setInteractive();return e.on("pointerup",(()=>{window.location.reload()})),e}bestScoreText(){return this.add.text(u.scale.width/2,u.scale.height/2+300,"Best Score : "+localStorage.getItem("playerScore"),{fontSize:"40px",color:"#ffffff",fontFamily:"Trebuchet MS"}).setOrigin(.5)}}],physics:{default:"arcade",arcade:{debug:!1,gravity:{y:400}}}};document.querySelector("canvas"),window.addEventListener("load",(()=>{!function(e){const t=()=>{e.renderer.resize(window.innerWidth,window.innerHeight)};t(),window.addEventListener("resize",t)}(new Phaser.Game(u))}))},204:()=>{console.log("%c %c %c %c %c Built using phaser-project-template %c https://github.com/yandeu/phaser-project-template","background: #ff0000","background: #ffff00","background: #00ff00","background: #00ffff","color: #fff; background: #000000;","background: none")}},s={};function a(e){var i=s[e];if(void 0!==i)return i.exports;var r=s[e]={exports:{}};return t[e].call(r.exports,r,r.exports,a),r.exports}a.m=t,e=[],a.O=(t,s,i,r)=>{if(!s){var n=1/0;for(l=0;l<e.length;l++){for(var[s,i,r]=e[l],o=!0,h=0;h<s.length;h++)(!1&r||n>=r)&&Object.keys(a.O).every((e=>a.O[e](s[h])))?s.splice(h--,1):(o=!1,r<n&&(n=r));if(o){e.splice(l--,1);var c=i();void 0!==c&&(t=c)}}return t}r=r||0;for(var l=e.length;l>0&&e[l-1][2]>r;l--)e[l]=e[l-1];e[l]=[s,i,r]},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={179:0};a.O.j=t=>0===e[t];var t=(t,s)=>{var i,r,[n,o,h]=s,c=0;if(n.some((t=>0!==e[t]))){for(i in o)a.o(o,i)&&(a.m[i]=o[i]);if(h)var l=h(a)}for(t&&t(s);c<n.length;c++)r=n[c],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(l)},s=self.webpackChunkphaser_match3=self.webpackChunkphaser_match3||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})(),a.O(void 0,[216],(()=>a(621)));var i=a.O(void 0,[216],(()=>a(204)));i=a.O(i)})();